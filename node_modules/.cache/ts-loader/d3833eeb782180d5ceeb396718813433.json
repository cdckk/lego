{"remainingRequest":"D:\\vue3-project\\lego\\node_modules\\babel-loader\\lib\\index.js!D:\\vue3-project\\lego\\node_modules\\ts-loader\\index.js??ref--15-2!D:\\vue3-project\\lego\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!D:\\vue3-project\\lego\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!D:\\vue3-project\\lego\\src\\components\\Uploader.vue?vue&type=script&setup=true&lang=ts","dependencies":[{"path":"D:\\vue3-project\\lego\\src\\components\\Uploader.vue","mtime":1677340121242},{"path":"D:\\vue3-project\\lego\\babel.config.js","mtime":1674816650140},{"path":"D:\\vue3-project\\lego\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1674816758787},{"path":"D:\\vue3-project\\lego\\node_modules\\babel-loader\\lib\\index.js","mtime":1674816767357},{"path":"D:\\vue3-project\\lego\\node_modules\\ts-loader\\index.js","mtime":1674816768512},{"path":"D:\\vue3-project\\lego\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1674816758787},{"path":"D:\\vue3-project\\lego\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1674816769351}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmVycm9yLmNhdXNlLmpzIjsKaW1wb3J0IHsgZGVmaW5lQ29tcG9uZW50IGFzIF9kZWZpbmVDb21wb25lbnQgfSBmcm9tICd2dWUnOwppbXBvcnQgeyByZWYsIHJlYWN0aXZlLCBjb21wdXRlZCB9IGZyb20gJ3Z1ZSc7CmltcG9ydCBGaWxlSW1hZ2VPdXRsaW5lZCwgeyBMb2FkaW5nT3V0bGluZWQsIEZpbGVPdXRsaW5lZCB9IGZyb20gJy4uLy4uL25vZGVfbW9kdWxlcy9AYW50LWRlc2lnbi9pY29ucy12dWUnOwppbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnOwppbXBvcnQgeyB2NCBhcyB1dWlkdjQgfSBmcm9tICd1dWlkJzsKaW1wb3J0IHsgbGFzdCB9IGZyb20gJ2xvZGFzaC1lcyc7CmltcG9ydCB7IHVzZVN0b3JlIH0gZnJvbSAndnVleCc7CmV4cG9ydCBkZWZhdWx0IC8qI19fUFVSRV9fKi9fZGVmaW5lQ29tcG9uZW50KHsKICBfX25hbWU6ICdVcGxvYWRlcicsCiAgcHJvcHM6IHsKICAgIGFjdGlvbjogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIGRlZmF1bHQ6ICdodHRwOi8vbG9jYWxob3N0OjMwMDAvZGF0YScKICAgIH0sCiAgICBiZWZvcmVVcGxvYWQ6IHsKICAgICAgdHlwZTogRnVuY3Rpb24KICAgIH0sCiAgICAvLyDmmK/lkKblvIDlkK/mi5bmi73kuIrkvKAKICAgIGRyYWc6IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgZGVmYXVsdDogZmFsc2UKICAgIH0sCiAgICAvLyDpu5jorqToh6rliqjkuIrkvKAKICAgIGF1dG9VcGxvYWQ6IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgZGVmYXVsdDogdHJ1ZQogICAgfSwKICAgIGxpc3RUeXBlOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgZGVmYXVsdDogJ3RleHQnCiAgICB9LAogICAgc2hvd1VwbG9hZGVkTGlzdDogewogICAgICB0eXBlOiBCb29sZWFuLAogICAgICBkZWZhdWx0OiB0cnVlCiAgICB9CiAgfSwKICBzZXR1cChfX3Byb3BzLCB7CiAgICBleHBvc2UKICB9KSB7CiAgICBjb25zdCBwcm9wcyA9IF9fcHJvcHM7CiAgICBjb25zdCBzdG9yZSA9IHVzZVN0b3JlKCk7CiAgICBjb25zdCBmaWxlSW5wdXQgPSByZWYobnVsbCk7CiAgICBjb25zdCBmaWxlU3RhdHVzID0gcmVmKCdyZWFkeScpOwogICAgY29uc3QgZmlsZXNMaXN0ID0gcmVmKFtdKTsKICAgIC8vIGNvbnN0IHVwbG9hZGVkRmlsZXMgPSByZWY8VXBsb2FkRmlsZVtdPihbXSkKICAgIGNvbnN0IGlzRHJhZ092ZXIgPSByZWYoZmFsc2UpOwogICAgY29uc3QgaXNVcGxvYWRpbmcgPSBjb21wdXRlZCgoKSA9PiB7CiAgICAgIC8vIOWPquimgeacieS4gOmhueeahOetieS6jmxvYWRpbmfvvIzmlbTkuKrmjInpkq7lsLHmmK9pc2xvYWRpbmcKICAgICAgcmV0dXJuIGZpbGVzTGlzdC52YWx1ZS5zb21lKGZpbGUgPT4gZmlsZS5zdGF0dXMgPT09ICdsb2FkaW5nJyk7CiAgICB9KTsKICAgIGNvbnN0IGxhc3RGaWxlRGF0YSA9IGNvbXB1dGVkKCgpID0+IHsKICAgICAgY29uc3QgbGFzdEZpbGUgPSBsYXN0KGZpbGVzTGlzdC52YWx1ZSk7CiAgICAgIGlmIChsYXN0RmlsZSkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICBsb2FkZWQ6IGxhc3RGaWxlLnN0YXR1cyA9PT0gJ3N1Y2Nlc3MnLAogICAgICAgICAgZGF0YTogbGFzdEZpbGUucmVzcAogICAgICAgIH07CiAgICAgIH0KICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSk7CiAgICBjb25zdCByZW1vdmVGaWxlID0gaWQgPT4gewogICAgICBmaWxlc0xpc3QudmFsdWUgPSBmaWxlc0xpc3QudmFsdWUuZmlsdGVyKGZpbGUgPT4gewogICAgICAgIHJldHVybiBmaWxlLnVpZCAhPT0gaWQ7CiAgICAgIH0pOwogICAgfTsKICAgIGNvbnN0IHRyaWdnZXJVcGxvYWRlciA9ICgpID0+IHsKICAgICAgaWYgKGZpbGVJbnB1dC52YWx1ZSkgewogICAgICAgIGZpbGVJbnB1dC52YWx1ZS5jbGljaygpOwogICAgICB9CiAgICB9OwogICAgY29uc3QgcG9zdEZpbGUgPSByZWFkeUZpbGUgPT4gewogICAgICBjb25zdCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpOwogICAgICAvLyBjb25zdCBpc2VFeGlzdGVuY2UgPSB1cGxvYWRlZEZpbGVzLnZhbHVlLnNvbWUoKGZpbGUpID0+IGZpbGUubmFtZSA9PT0gZmlsZU9iai5uYW1lICkKICAgICAgLy8gaWYoIWlzZUV4aXN0ZW5jZSkgewogICAgICAvLyB1cGxvYWRlZEZpbGVzLnZhbHVlLnB1c2goZmlsZU9iaikKICAgICAgLy8gfQogICAgICBmb3JtRGF0YS5hcHBlbmQocmVhZHlGaWxlLm5hbWUsIHJlYWR5RmlsZS5yYXcpOwogICAgICByZWFkeUZpbGUuc3RhdHVzID0gJ2xvYWRpbmcnOwogICAgICBheGlvcy5wb3N0KHByb3BzLmFjdGlvbiwgZm9ybURhdGEsIHsKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ211bHRpcGFydC9mb3JtLWRhdGEnCiAgICAgICAgfQogICAgICB9KS50aGVuKHJlcyA9PiB7CiAgICAgICAgY29uc29sZS5sb2coJ+S4iuS8oOaIkOWKnycsIHJlcy5kYXRhKTsKICAgICAgICAvLyBjb25zb2xlLmxvZyhyZWFkeUZpbGUucmF3KTsKICAgICAgICAvLyBjb25zb2xlLmxvZyhyZWFkeUZpbGUudXJsKTsKICAgICAgICByZXMuZGF0YS51cmwgPSByZWFkeUZpbGUudXJsOwogICAgICAgIGZpbGVTdGF0dXMudmFsdWUgPSAnc3VjY2Vzcyc7CiAgICAgICAgcmVhZHlGaWxlLnN0YXR1cyA9ICdzdWNjZXNzJzsKICAgICAgICByZWFkeUZpbGUucmVzcCA9IHJlcy5kYXRhOwogICAgICAgIGNvbnNvbGUubG9nKCdyZWFkeUZpbGUucmVzcCcsIHJlYWR5RmlsZS5yZXNwKTsKICAgICAgICBjb25zdCBpbWFnZVByb3BzID0gewogICAgICAgICAgc3JjOiByZWFkeUZpbGUucmVzcAogICAgICAgIH07CiAgICAgIH0pLmNhdGNoKGVyciA9PiB7CiAgICAgICAgY29uc29sZS5sb2coJ+S4iuS8oOWksei0pScsIGVycik7CiAgICAgICAgZmlsZVN0YXR1cy52YWx1ZSA9ICdlcnJvcic7CiAgICAgICAgcmVhZHlGaWxlLnN0YXR1cyA9ICdlcnJvcic7CiAgICAgIH0pLmZpbmFsbHkoKCkgPT4gewogICAgICAgIGlmIChmaWxlSW5wdXQudmFsdWUpIHsKICAgICAgICAgIGZpbGVJbnB1dC52YWx1ZS52YWx1ZSA9ICcnOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9OwogICAgY29uc3QgYWRkRmlsZVRvTGlzdCA9IHVwbG9hZGVkRmlsZSA9PiB7CiAgICAgIGNvbnN0IGZpbGVPYmogPSByZWFjdGl2ZSh7CiAgICAgICAgdWlkOiB1dWlkdjQoKSwKICAgICAgICBzaXplOiB1cGxvYWRlZEZpbGUuc2l6ZSwKICAgICAgICBuYW1lOiB1cGxvYWRlZEZpbGUubmFtZSwKICAgICAgICBzdGF0dXM6ICdyZWFkeScsCiAgICAgICAgcmF3OiB1cGxvYWRlZEZpbGUKICAgICAgfSk7CiAgICAgIGlmIChwcm9wcy5saXN0VHlwZSA9PT0gJ3BpY3R1cmUnKSB7CiAgICAgICAgLy8g6Ziy5q2i6L2s5o2i6ZSZ6K+vCiAgICAgICAgdHJ5IHsKICAgICAgICAgIGZpbGVPYmoudXJsID0gVVJMLmNyZWF0ZU9iamVjdFVSTCh1cGxvYWRlZEZpbGUpOwogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgY29uc29sZS5lcnJvcigndXBsb2FkIGZpbGUgZXJyb3InLCBlcnIpOwogICAgICAgIH0KICAgICAgICAvLyBjb25zdCBmaWxlUmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKQogICAgICAgIC8vIGZpbGVSZWFkZXIucmVhZEFzRGF0YVVSTCh1cGxvYWRlZEZpbGUpCiAgICAgICAgLy8gZmlsZVJlYWRlci5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgKCkgPT4gewogICAgICAgIC8vICAgZmlsZU9iai51cmwgPSBmaWxlUmVhZGVyLnJlc3VsdCBhcyBzdHJpbmcKICAgICAgICAvLyB9KQogICAgICB9CgogICAgICBmaWxlc0xpc3QudmFsdWUucHVzaChmaWxlT2JqKTsKICAgICAgLy8gY29uc29sZS5sb2coZmlsZXNMaXN0LnZhbHVlKTsKICAgICAgaWYgKHByb3BzLmF1dG9VcGxvYWQpIHsKICAgICAgICBwb3N0RmlsZShmaWxlT2JqKTsKICAgICAgfQogICAgfTsKICAgIGNvbnN0IGJlZm9yZVVwbG9hZENoZWNrID0gZmlsZXMgPT4gewogICAgICBpZiAoZmlsZXMpIHsKICAgICAgICBjb25zdCB1cGxvYWRlZEZpbGUgPSBmaWxlc1swXTsKICAgICAgICAvLyDkuIrkvKDliY3nmoTmo4Dmn6UKICAgICAgICBpZiAocHJvcHMuYmVmb3JlVXBsb2FkKSB7CiAgICAgICAgICBjb25zdCByZXN1bHQgPSBwcm9wcy5iZWZvcmVVcGxvYWQodXBsb2FkZWRGaWxlKTsKICAgICAgICAgIGlmIChyZXN1bHQgJiYgcmVzdWx0IGluc3RhbmNlb2YgUHJvbWlzZSkgewogICAgICAgICAgICByZXN1bHQudGhlbihwcm9jZXNzRmlsZSA9PiB7CiAgICAgICAgICAgICAgLyoqDQogICAgICAgICAgICAgICAqIOaWsOWGkuWHuuadpeeahOWvueixoe+8jOW5tuS4jeefpemBk+aYr+S7gOS5iOexu+Wei++8jOebtOaOpei/m+ihjOWkhOeQhuS8muaciemXrumimA0KICAgICAgICAgICAgICAgKi8KICAgICAgICAgICAgICAvLyDov5nph4zlubbkuI3nn6XpgZNwcm9jZXNzRmlsZeeahOexu+Wei++8jOimgeWIpOaWrQogICAgICAgICAgICAgIGlmIChwcm9jZXNzRmlsZSBpbnN0YW5jZW9mIEZpbGUpIHsKICAgICAgICAgICAgICAgIGFkZEZpbGVUb0xpc3QocHJvY2Vzc0ZpbGUpOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2JlZm9yZVVwbG9hZCBQcm9taXNlIHNob3VsZCByZXR1cm4gRmlsZSBvYmplY3QnKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pLmNhdGNoKGUgPT4gewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKGUpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gZWxzZSBpZiAocmVzdWx0ID09PSB0cnVlKSB7CiAgICAgICAgICAgIGFkZEZpbGVUb0xpc3QodXBsb2FkZWRGaWxlKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgYWRkRmlsZVRvTGlzdCh1cGxvYWRlZEZpbGUpOwogICAgICAgIH0KICAgICAgfQogICAgfTsKICAgIC8vIOaatOmcsuWHunVwbG9hZEZpbGVz5pa55rOVCiAgICBjb25zdCB1cGxvYWRGaWxlcyA9ICgpID0+IHsKICAgICAgZmlsZXNMaXN0LnZhbHVlLmZpbHRlcihmaWxlID0+IGZpbGUuc3RhdHVzID0gJ3JlYWR5JykuZm9yRWFjaChyZWFkeUZpbGUgPT4gcG9zdEZpbGUocmVhZHlGaWxlKSk7CiAgICB9OwogICAgbGV0IGV2ZW50cyA9IHsKICAgICAgJ2NsaWNrJzogdHJpZ2dlclVwbG9hZGVyCiAgICB9OwogICAgLy8g5b2T5LiK5Lyg5qGG5pyJ5Zu+54mHCiAgICBjb25zdCBoYW5kbGVGaWxlQ2hhbmdlID0gZSA9PiB7CiAgICAgIC8vIGNvbnNvbGUubG9nKGUpOwogICAgICBjb25zdCB0YXJnZXQgPSBlLnRhcmdldDsKICAgICAgY29uc3QgZmlsZXMgPSB0YXJnZXQuZmlsZXM7CiAgICAgIGJlZm9yZVVwbG9hZENoZWNrKGZpbGVzKTsKICAgIH07CiAgICAvLyDmi5YKICAgIGNvbnN0IGhhbmRsZURyYWcgPSAoZSwgb3ZlcikgPT4gewogICAgICAvLyDnrKzkuozkuKrlj4LmlbDku6PooahjbGFzc+a3u+WKoOaIluiAheS4jea3u+WKoAogICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgIGlzRHJhZ092ZXIudmFsdWUgPSBvdmVyOwogICAgfTsKICAgIC8vIOiQveS4iwogICAgY29uc3QgaGFuZGxlRHJvcCA9IGUgPT4gewogICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgIGlzRHJhZ092ZXIudmFsdWUgPSBmYWxzZTsKICAgICAgaWYgKGUuZGF0YVRyYW5zZmVyKSB7CiAgICAgICAgLy8g5ou/5Yiw5omY5pS+5LiL55qE5pWw5o2uCiAgICAgICAgYmVmb3JlVXBsb2FkQ2hlY2soZS5kYXRhVHJhbnNmZXIuZmlsZXMpOwogICAgICB9CiAgICB9OwogICAgLy8g5re75Yqg5YW25LuW55qE5LqL5Lu2CiAgICBpZiAocHJvcHMuZHJhZykgewogICAgICBldmVudHMgPSB7CiAgICAgICAgLi4uZXZlbnRzLAogICAgICAgICdkcmFnb3Zlcic6IGUgPT4gewogICAgICAgICAgaGFuZGxlRHJhZyhlLCB0cnVlKTsKICAgICAgICB9LAogICAgICAgICdkcmFnbGVhdmUnOiBlID0+IHsKICAgICAgICAgIGhhbmRsZURyYWcoZSwgZmFsc2UpOwogICAgICAgIH0sCiAgICAgICAgJ2Ryb3AnOiBoYW5kbGVEcm9wCiAgICAgIH07CiAgICB9CiAgICBleHBvc2UoewogICAgICB1cGxvYWRGaWxlcwogICAgfSk7CiAgICBjb25zdCBfX3JldHVybmVkX18gPSB7CiAgICAgIHByb3BzLAogICAgICBzdG9yZSwKICAgICAgZmlsZUlucHV0LAogICAgICBmaWxlU3RhdHVzLAogICAgICBmaWxlc0xpc3QsCiAgICAgIGlzRHJhZ092ZXIsCiAgICAgIGlzVXBsb2FkaW5nLAogICAgICBsYXN0RmlsZURhdGEsCiAgICAgIHJlbW92ZUZpbGUsCiAgICAgIHRyaWdnZXJVcGxvYWRlciwKICAgICAgcG9zdEZpbGUsCiAgICAgIGFkZEZpbGVUb0xpc3QsCiAgICAgIGJlZm9yZVVwbG9hZENoZWNrLAogICAgICB1cGxvYWRGaWxlcywKICAgICAgZ2V0IGV2ZW50cygpIHsKICAgICAgICByZXR1cm4gZXZlbnRzOwogICAgICB9LAogICAgICBzZXQgZXZlbnRzKHYpIHsKICAgICAgICBldmVudHMgPSB2OwogICAgICB9LAogICAgICBoYW5kbGVGaWxlQ2hhbmdlLAogICAgICBoYW5kbGVEcmFnLAogICAgICBoYW5kbGVEcm9wLAogICAgICBnZXQgRmlsZUltYWdlT3V0bGluZWQoKSB7CiAgICAgICAgcmV0dXJuIEZpbGVJbWFnZU91dGxpbmVkOwogICAgICB9LAogICAgICBnZXQgTG9hZGluZ091dGxpbmVkKCkgewogICAgICAgIHJldHVybiBMb2FkaW5nT3V0bGluZWQ7CiAgICAgIH0sCiAgICAgIGdldCBGaWxlT3V0bGluZWQoKSB7CiAgICAgICAgcmV0dXJuIEZpbGVPdXRsaW5lZDsKICAgICAgfQogICAgfTsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShfX3JldHVybmVkX18sICdfX2lzU2NyaXB0U2V0dXAnLCB7CiAgICAgIGVudW1lcmFibGU6IGZhbHNlLAogICAgICB2YWx1ZTogdHJ1ZQogICAgfSk7CiAgICByZXR1cm4gX19yZXR1cm5lZF9fOwogIH0KfSk7"},{"version":3,"mappings":"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","names":["defineComponent","_defineComponent","ref","reactive","computed","FileImageOutlined","LoadingOutlined","FileOutlined","axios","v4","uuidv4","last","useStore","__name","props","action","type","String","default","beforeUpload","Function","drag","Boolean","autoUpload","listType","showUploadedList","setup","__props","expose","store","fileInput","fileStatus","filesList","isDragOver","isUploading","value","some","file","status","lastFileData","lastFile","loaded","data","resp","removeFile","id","filter","uid","triggerUploader","click","postFile","readyFile","formData","FormData","append","name","raw","post","headers","then","res","console","log","url","imageProps","src","catch","err","finally","addFileToList","uploadedFile","fileObj","size","URL","createObjectURL","error","push","beforeUploadCheck","files","result","Promise","processFile","File","Error","e","uploadFiles","forEach","events","handleFileChange","target","handleDrag","over","preventDefault","handleDrop","dataTransfer","__returned__","v","Object","defineProperty","enumerable"],"sourceRoot":"","sources":["D:\\vue3-project\\lego\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!D:\\vue3-project\\lego\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!D:\\vue3-project\\lego\\src\\components\\Uploader.vue?vue&type=script&setup=true&lang=ts"],"sourcesContent":["import { defineComponent as _defineComponent } from 'vue'\nimport { ref, reactive, computed, PropType } from 'vue'\r\nimport FileImageOutlined, {LoadingOutlined, FileOutlined} from '../../node_modules/@ant-design/icons-vue'\r\nimport axios from 'axios'\r\nimport { v4 as uuidv4} from 'uuid'\r\nimport { last } from 'lodash-es'\r\nimport { useStore } from 'vuex'\r\nimport {ImageComponentProps} from '../defaultProps'\r\n\r\ntype uploadStatus = 'ready' | 'loading' | 'success' | 'error'\r\n// picture带预览的功能\r\ntype FileListType = 'picture' | 'text '\r\ntype CheckUpload = (file: File) => boolean | Promise<File>\r\nexport interface UploadFile {\r\n uid: string;\r\n name: string;\r\n size: number;\r\n status: string;\r\n raw: File;\r\n resp?: any;\r\n url?: string;\r\n}\r\n\r\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'Uploader',\n  props: {\r\n  action: {\r\n    type: String,\r\n    default: 'http://localhost:3000/data'\r\n  },\r\n  beforeUpload: {\r\n    type: Function as PropType<CheckUpload>\r\n  },\r\n  // 是否开启拖拽上传\r\n  drag: {\r\n    type: Boolean,\r\n    default: false\r\n  },\r\n  // 默认自动上传\r\n  autoUpload: {\r\n    type: Boolean,\r\n    default: true\r\n  },\r\n  listType: {\r\n    type: String as PropType<FileListType>,\r\n    default: 'text'\r\n  },\r\n  showUploadedList: {\r\n    type: Boolean,\r\n    default: true\r\n  }\r\n},\n  setup(__props, { expose }) {\n\nconst props = __props;\n\r\n\r\n\r\nconst store = useStore()\r\n\r\nconst fileInput = ref<null | HTMLInputElement>(null)\r\nconst fileStatus = ref<uploadStatus>('ready')\r\nconst filesList = ref<UploadFile[]>([])\r\n// const uploadedFiles = ref<UploadFile[]>([])\r\nconst isDragOver = ref(false)\r\nconst isUploading = computed(() => {\r\n  // 只要有一项的等于loading，整个按钮就是isloading\r\n  return filesList.value.some(file => file.status === 'loading' )\r\n})\r\nconst lastFileData = computed(() => {\r\n  const lastFile = last(filesList.value)\r\n  if (lastFile) {\r\n    return {\r\n      loaded: lastFile.status === 'success',\r\n      data: lastFile.resp\r\n    }\r\n  }\r\n  return false\r\n})\r\nconst removeFile = (id: string) => {\r\n  filesList.value = filesList.value.filter(file => {\r\n    return file.uid !== id\r\n  })\r\n}\r\n\r\nconst triggerUploader = () => {\r\n  if (fileInput.value) {\r\n    fileInput.value.click()\r\n  }\r\n}\r\n\r\nconst postFile = (readyFile: UploadFile) => {\r\n  const formData = new FormData() \r\n  // const iseExistence = uploadedFiles.value.some((file) => file.name === fileObj.name )\r\n  // if(!iseExistence) {\r\n  // uploadedFiles.value.push(fileObj)\r\n  // }\r\n  \r\n  formData.append(readyFile.name, readyFile.raw)\r\n  readyFile.status = 'loading'\r\n  axios.post(props.action, formData, {\r\n    headers: {\r\n      'Content-Type': 'multipart/form-data'\r\n    }\r\n  }).then(res => {\r\n    console.log('上传成功',res.data);\r\n    // console.log(readyFile.raw);\r\n    // console.log(readyFile.url);\r\n    res.data.url = readyFile.url\r\n    fileStatus.value = 'success'\r\n    readyFile.status = 'success'\r\n    readyFile.resp = res.data\r\n    console.log('readyFile.resp',readyFile.resp);\r\n    const imageProps: ImageComponentProps = {\r\n      src: readyFile.resp\r\n    }\r\n  }).catch((err) => {\r\n    console.log('上传失败', err);\r\n    fileStatus.value = 'error'\r\n    readyFile.status = 'error'\r\n  }).finally(() => {\r\n    if (fileInput.value) {\r\n      fileInput.value.value = ''\r\n    }\r\n  })\r\n}\r\n\r\nconst addFileToList = (uploadedFile: File) => {\r\n  const fileObj = reactive<UploadFile>({\r\n    uid: uuidv4(),\r\n    size: uploadedFile.size,\r\n    name: uploadedFile.name,\r\n    status: 'ready',\r\n    raw: uploadedFile\r\n  })\r\n  if (props.listType === 'picture') {\r\n    // 防止转换错误\r\n    try {\r\n      fileObj.url = URL.createObjectURL(uploadedFile)\r\n    } catch (err) {\r\n      console.error('upload file error', err)\r\n    }\r\n    // const fileReader = new FileReader()\r\n    // fileReader.readAsDataURL(uploadedFile)\r\n    // fileReader.addEventListener('load', () => {\r\n    //   fileObj.url = fileReader.result as string\r\n    // })\r\n  }\r\n  filesList.value.push(fileObj)\r\n  // console.log(filesList.value);\r\n  \r\n  if (props.autoUpload) {\r\n    postFile(fileObj)\r\n  }\r\n}\r\n\r\nconst beforeUploadCheck = (files: null | FileList) => {\r\n  if (files) {\r\n    const uploadedFile = files[0]\r\n    // 上传前的检查\r\n    if (props.beforeUpload) {\r\n      const result = props.beforeUpload(uploadedFile)\r\n      if (result && result instanceof Promise) {\r\n        result.then(processFile => {\r\n          /**\r\n           * 新冒出来的对象，并不知道是什么类型，直接进行处理会有问题\r\n           */\r\n          // 这里并不知道processFile的类型，要判断\r\n          if (processFile instanceof File) {\r\n            addFileToList(processFile)\r\n          } else {\r\n            throw new Error('beforeUpload Promise should return File object')\r\n          }\r\n        }).catch(e => {\r\n          console.log(e);\r\n        })\r\n      } else if (result === true) {\r\n        addFileToList(uploadedFile)\r\n      }\r\n    } else {\r\n      addFileToList(uploadedFile)\r\n    }\r\n  }\r\n}\r\n\r\n// 暴露出uploadFiles方法\r\nconst uploadFiles = () => {\r\n  filesList.value.filter(file => file.status = 'ready').forEach(readyFile => postFile(readyFile))\r\n}\r\n\r\nlet events: { [key: string]: (e: any) => void } = {\r\n  'click': triggerUploader\r\n}\r\n\r\n// 当上传框有图片\r\nconst handleFileChange = (e: Event) => {\r\n  // console.log(e);\r\n  \r\n  const target = e.target as HTMLInputElement\r\n  const files = target.files\r\n  beforeUploadCheck(files)\r\n}\r\n\r\n// 拖\r\nconst handleDrag = (e: DragEvent, over: boolean) => {\r\n  // 第二个参数代表class添加或者不添加\r\n  e.preventDefault()\r\n  isDragOver.value = over\r\n}\r\n// 落下\r\nconst handleDrop = (e: DragEvent) => {\r\n  e.preventDefault()\r\n  isDragOver.value = false\r\n  if (e.dataTransfer) {\r\n    // 拿到托放下的数据\r\n    beforeUploadCheck(e.dataTransfer.files)\r\n  }\r\n}\r\n\r\n// 添加其他的事件\r\nif (props.drag) {\r\n  events = {\r\n    ...events,\r\n    'dragover': (e: DragEvent) => { handleDrag(e, true) },\r\n    'dragleave': (e: DragEvent) => { handleDrag(e, false) },\r\n    'drop': handleDrop\r\n  }\r\n}\r\n\r\nexpose({\r\n  uploadFiles\r\n})\r\n\r\n\nconst __returned__ = { props, store, fileInput, fileStatus, filesList, isDragOver, isUploading, lastFileData, removeFile, triggerUploader, postFile, addFileToList, beforeUploadCheck, uploadFiles, get events() { return events }, set events(v) { events = v }, handleFileChange, handleDrag, handleDrop, get FileImageOutlined() { return FileImageOutlined }, get LoadingOutlined() { return LoadingOutlined }, get FileOutlined() { return FileOutlined } }\nObject.defineProperty(__returned__, '__isScriptSetup', { enumerable: false, value: true })\nreturn __returned__\n}\n\n})"]}]}