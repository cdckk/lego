{"remainingRequest":"D:\\vue3-project\\lego\\node_modules\\babel-loader\\lib\\index.js!D:\\vue3-project\\lego\\node_modules\\ts-loader\\index.js??ref--15-2!D:\\vue3-project\\lego\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!D:\\vue3-project\\lego\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!D:\\vue3-project\\lego\\src\\components\\Uploader.vue?vue&type=script&setup=true&lang=ts","dependencies":[{"path":"D:\\vue3-project\\lego\\src\\components\\Uploader.vue","mtime":1677663984242},{"path":"D:\\vue3-project\\lego\\babel.config.js","mtime":1679070494323},{"path":"D:\\vue3-project\\lego\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1674816758787},{"path":"D:\\vue3-project\\lego\\node_modules\\babel-loader\\lib\\index.js","mtime":1674816767357},{"path":"D:\\vue3-project\\lego\\node_modules\\ts-loader\\index.js","mtime":1674816768512},{"path":"D:\\vue3-project\\lego\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1674816758787},{"path":"D:\\vue3-project\\lego\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1674816769351}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmVycm9yLmNhdXNlLmpzIjsKaW1wb3J0IHsgZGVmaW5lQ29tcG9uZW50IGFzIF9kZWZpbmVDb21wb25lbnQgfSBmcm9tICd2dWUnOwppbXBvcnQgeyByZWYsIHJlYWN0aXZlLCBjb21wdXRlZCB9IGZyb20gJ3Z1ZSc7CmltcG9ydCBGaWxlSW1hZ2VPdXRsaW5lZCwgeyBMb2FkaW5nT3V0bGluZWQsIEZpbGVPdXRsaW5lZCB9IGZyb20gJy4uLy4uL25vZGVfbW9kdWxlcy9AYW50LWRlc2lnbi9pY29ucy12dWUnOwppbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnOwppbXBvcnQgeyB2NCBhcyB1dWlkdjQgfSBmcm9tICd1dWlkJzsKaW1wb3J0IHsgbGFzdCB9IGZyb20gJ2xvZGFzaC1lcyc7CmltcG9ydCB7IHVzZVN0b3JlIH0gZnJvbSAndnVleCc7CmltcG9ydCB7IGdldEltYWdlRGltZW5zaW9ucyB9IGZyb20gJy4uL2hlbHBlcic7CmV4cG9ydCBkZWZhdWx0IC8qI19fUFVSRV9fKi9fZGVmaW5lQ29tcG9uZW50KHsKICBfX25hbWU6ICdVcGxvYWRlcicsCiAgcHJvcHM6IHsKICAgIGFjdGlvbjogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIGRlZmF1bHQ6ICdodHRwOi8vbG9jYWxob3N0OjMwMDAvZGF0YScKICAgIH0sCiAgICBiZWZvcmVVcGxvYWQ6IHsKICAgICAgdHlwZTogRnVuY3Rpb24KICAgIH0sCiAgICAvLyDmmK/lkKblvIDlkK/mi5bmi73kuIrkvKAKICAgIGRyYWc6IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgZGVmYXVsdDogZmFsc2UKICAgIH0sCiAgICAvLyDpu5jorqToh6rliqjkuIrkvKAKICAgIGF1dG9VcGxvYWQ6IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgZGVmYXVsdDogdHJ1ZQogICAgfSwKICAgIGxpc3RUeXBlOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgZGVmYXVsdDogJ3RleHQnCiAgICB9LAogICAgc2hvd1VwbG9hZGVkTGlzdDogewogICAgICB0eXBlOiBCb29sZWFuLAogICAgICBkZWZhdWx0OiB0cnVlCiAgICB9CiAgfSwKICBzZXR1cChfX3Byb3BzLCB7CiAgICBleHBvc2UKICB9KSB7CiAgICBjb25zdCBwcm9wcyA9IF9fcHJvcHM7CiAgICBjb25zdCBzdG9yZSA9IHVzZVN0b3JlKCk7CiAgICBjb25zdCBmaWxlSW5wdXQgPSByZWYobnVsbCk7CiAgICBjb25zdCBmaWxlU3RhdHVzID0gcmVmKCdyZWFkeScpOwogICAgY29uc3QgZmlsZXNMaXN0ID0gcmVmKFtdKTsKICAgIC8vIGNvbnN0IHVwbG9hZGVkRmlsZXMgPSByZWY8VXBsb2FkRmlsZVtdPihbXSkKICAgIGNvbnN0IGlzRHJhZ092ZXIgPSByZWYoZmFsc2UpOwogICAgY29uc3QgaXNVcGxvYWRpbmcgPSBjb21wdXRlZCgoKSA9PiB7CiAgICAgIC8vIOWPquimgeacieS4gOmhueeahOetieS6jmxvYWRpbmfvvIzmlbTkuKrmjInpkq7lsLHmmK9pc2xvYWRpbmcKICAgICAgcmV0dXJuIGZpbGVzTGlzdC52YWx1ZS5zb21lKGZpbGUgPT4gZmlsZS5zdGF0dXMgPT09ICdsb2FkaW5nJyk7CiAgICB9KTsKICAgIGNvbnN0IGxhc3RGaWxlRGF0YSA9IGNvbXB1dGVkKCgpID0+IHsKICAgICAgY29uc3QgbGFzdEZpbGUgPSBsYXN0KGZpbGVzTGlzdC52YWx1ZSk7CiAgICAgIGlmIChsYXN0RmlsZSkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICBsb2FkZWQ6IGxhc3RGaWxlLnN0YXR1cyA9PT0gJ3N1Y2Nlc3MnLAogICAgICAgICAgZGF0YTogbGFzdEZpbGUucmVzcAogICAgICAgIH07CiAgICAgIH0KICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSk7CiAgICBjb25zdCByZW1vdmVGaWxlID0gaWQgPT4gewogICAgICBmaWxlc0xpc3QudmFsdWUgPSBmaWxlc0xpc3QudmFsdWUuZmlsdGVyKGZpbGUgPT4gewogICAgICAgIHJldHVybiBmaWxlLnVpZCAhPT0gaWQ7CiAgICAgIH0pOwogICAgfTsKICAgIGNvbnN0IHRyaWdnZXJVcGxvYWRlciA9ICgpID0+IHsKICAgICAgaWYgKGZpbGVJbnB1dC52YWx1ZSkgewogICAgICAgIGZpbGVJbnB1dC52YWx1ZS5jbGljaygpOwogICAgICB9CiAgICB9OwogICAgY29uc3QgcG9zdEZpbGUgPSByZWFkeUZpbGUgPT4gewogICAgICBjb25zdCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpOwogICAgICAvLyBjb25zdCBpc2VFeGlzdGVuY2UgPSB1cGxvYWRlZEZpbGVzLnZhbHVlLnNvbWUoKGZpbGUpID0+IGZpbGUubmFtZSA9PT0gZmlsZU9iai5uYW1lICkKICAgICAgLy8gaWYoIWlzZUV4aXN0ZW5jZSkgewogICAgICAvLyB1cGxvYWRlZEZpbGVzLnZhbHVlLnB1c2goZmlsZU9iaikKICAgICAgLy8gfQogICAgICBmb3JtRGF0YS5hcHBlbmQocmVhZHlGaWxlLm5hbWUsIHJlYWR5RmlsZS5yYXcpOwogICAgICByZWFkeUZpbGUuc3RhdHVzID0gJ2xvYWRpbmcnOwogICAgICBheGlvcy5wb3N0KHByb3BzLmFjdGlvbiwgZm9ybURhdGEsIHsKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ211bHRpcGFydC9mb3JtLWRhdGEnCiAgICAgICAgfQogICAgICB9KS50aGVuKHJlcyA9PiB7CiAgICAgICAgY29uc29sZS5sb2coJ+S4iuS8oOaIkOWKnycsIHJlcy5kYXRhKTsKICAgICAgICAvLyBjb25zb2xlLmxvZyhyZWFkeUZpbGUucmF3KTsKICAgICAgICAvLyBjb25zb2xlLmxvZyhyZWFkeUZpbGUudXJsKTsKICAgICAgICByZXMuZGF0YS51cmwgPSByZWFkeUZpbGUudXJsOwogICAgICAgIGZpbGVTdGF0dXMudmFsdWUgPSAnc3VjY2Vzcyc7CiAgICAgICAgcmVhZHlGaWxlLnN0YXR1cyA9ICdzdWNjZXNzJzsKICAgICAgICBjb25zdCBnZXRXaWR0aCA9IHdpZHRoID0+IHsKICAgICAgICAgIGNvbnN0IG1heFdpZHRoID0gMzc1OwogICAgICAgICAgcmVzLmRhdGEud2lkdGggPSB3aWR0aCA+IG1heFdpZHRoID8gbWF4V2lkdGggOiB3aWR0aDsKICAgICAgICB9OwogICAgICAgIHRyeSB7CiAgICAgICAgICBnZXRJbWFnZURpbWVuc2lvbnMocmVzLmRhdGEudXJsKS50aGVuKGFzeW5jICh7CiAgICAgICAgICAgIHdpZHRoCiAgICAgICAgICB9KSA9PiB7CiAgICAgICAgICAgIC8vIGdldEltYWdlRGltZW5zaW9ucyhyZWFkeUZpbGUucmVzcC51cmwpLnRoZW4oYXN5bmMgKHt3aWR0aH0pID0+IHsKICAgICAgICAgICAgYXdhaXQgZ2V0V2lkdGgod2lkdGgpOwogICAgICAgICAgICAvLyBjb25zb2xlLmxvZygncmVzLmRhdGEnLCByZXMuZGF0YSk7CiAgICAgICAgICB9KTsKICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgY29uc29sZS5sb2coJ2Vycm9yJywgZXJyb3IpOwogICAgICAgIH0KICAgICAgICByZWFkeUZpbGUucmVzcCA9IHJlcy5kYXRhOwogICAgICAgIC8vIGNvbnNvbGUubG9nKCdyZWFkeUZpbGUucmVzcC53aWR0aCcscmVhZHlGaWxlLnJlc3Aud2lkdGgpOwogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgY29uc3QgaW1hZ2VQcm9wcyA9IHsKICAgICAgICAgICAgc3JjOiByZWFkeUZpbGUucmVzcC51cmwsCiAgICAgICAgICAgIHdpZHRoOiByZWFkeUZpbGUucmVzcC53aWR0aAogICAgICAgICAgfTsKICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdpbWFnZVByb3BzJyxpbWFnZVByb3BzKTsKICAgICAgICAgIHN0b3JlLmNvbW1pdCgnYWRkQ29tcG9uZW50JywgaW1hZ2VQcm9wcyk7CiAgICAgICAgfSwgNTAwKTsKICAgICAgfSkuY2F0Y2goZXJyID0+IHsKICAgICAgICBjb25zb2xlLmxvZygn5LiK5Lyg5aSx6LSlJywgZXJyKTsKICAgICAgICBmaWxlU3RhdHVzLnZhbHVlID0gJ2Vycm9yJzsKICAgICAgICByZWFkeUZpbGUuc3RhdHVzID0gJ2Vycm9yJzsKICAgICAgfSkuZmluYWxseSgoKSA9PiB7CiAgICAgICAgaWYgKGZpbGVJbnB1dC52YWx1ZSkgewogICAgICAgICAgZmlsZUlucHV0LnZhbHVlLnZhbHVlID0gJyc7CiAgICAgICAgfQogICAgICB9KTsKICAgIH07CiAgICBjb25zdCBhZGRGaWxlVG9MaXN0ID0gdXBsb2FkZWRGaWxlID0+IHsKICAgICAgY29uc3QgZmlsZU9iaiA9IHJlYWN0aXZlKHsKICAgICAgICB1aWQ6IHV1aWR2NCgpLAogICAgICAgIHNpemU6IHVwbG9hZGVkRmlsZS5zaXplLAogICAgICAgIG5hbWU6IHVwbG9hZGVkRmlsZS5uYW1lLAogICAgICAgIHN0YXR1czogJ3JlYWR5JywKICAgICAgICByYXc6IHVwbG9hZGVkRmlsZQogICAgICB9KTsKICAgICAgaWYgKHByb3BzLmxpc3RUeXBlID09PSAncGljdHVyZScpIHsKICAgICAgICAvLyDpmLLmraLovazmjaLplJnor68KICAgICAgICAvLyB0cnkgewogICAgICAgIC8vICAgZmlsZU9iai51cmwgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKHVwbG9hZGVkRmlsZSkKICAgICAgICAvLyB9IGNhdGNoIChlcnIpIHsKICAgICAgICAvLyAgIGNvbnNvbGUuZXJyb3IoJ3VwbG9hZCBmaWxlIGVycm9yJywgZXJyKQogICAgICAgIC8vIH0KICAgICAgICBjb25zdCBmaWxlUmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsKICAgICAgICBmaWxlUmVhZGVyLnJlYWRBc0RhdGFVUkwodXBsb2FkZWRGaWxlKTsKICAgICAgICBmaWxlUmVhZGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCAoKSA9PiB7CiAgICAgICAgICBmaWxlT2JqLnVybCA9IGZpbGVSZWFkZXIucmVzdWx0OwogICAgICAgIH0pOwogICAgICB9CiAgICAgIGZpbGVzTGlzdC52YWx1ZS5wdXNoKGZpbGVPYmopOwogICAgICAvLyBjb25zb2xlLmxvZyhmaWxlc0xpc3QudmFsdWUpOwogICAgICBpZiAocHJvcHMuYXV0b1VwbG9hZCkgewogICAgICAgIHBvc3RGaWxlKGZpbGVPYmopOwogICAgICB9CiAgICB9OwogICAgY29uc3QgYmVmb3JlVXBsb2FkQ2hlY2sgPSBmaWxlcyA9PiB7CiAgICAgIGlmIChmaWxlcykgewogICAgICAgIGNvbnN0IHVwbG9hZGVkRmlsZSA9IGZpbGVzWzBdOwogICAgICAgIC8vIOS4iuS8oOWJjeeahOajgOafpQogICAgICAgIGlmIChwcm9wcy5iZWZvcmVVcGxvYWQpIHsKICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHByb3BzLmJlZm9yZVVwbG9hZCh1cGxvYWRlZEZpbGUpOwogICAgICAgICAgaWYgKHJlc3VsdCAmJiByZXN1bHQgaW5zdGFuY2VvZiBQcm9taXNlKSB7CiAgICAgICAgICAgIHJlc3VsdC50aGVuKHByb2Nlc3NGaWxlID0+IHsKICAgICAgICAgICAgICAvKioNCiAgICAgICAgICAgICAgICog5paw5YaS5Ye65p2l55qE5a+56LGh77yM5bm25LiN55+l6YGT5piv5LuA5LmI57G75Z6L77yM55u05o6l6L+b6KGM5aSE55CG5Lya5pyJ6Zeu6aKYDQogICAgICAgICAgICAgICAqLwogICAgICAgICAgICAgIC8vIOi/memHjOW5tuS4jeefpemBk3Byb2Nlc3NGaWxl55qE57G75Z6L77yM6KaB5Yik5patCiAgICAgICAgICAgICAgaWYgKHByb2Nlc3NGaWxlIGluc3RhbmNlb2YgRmlsZSkgewogICAgICAgICAgICAgICAgYWRkRmlsZVRvTGlzdChwcm9jZXNzRmlsZSk7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignYmVmb3JlVXBsb2FkIFByb21pc2Ugc2hvdWxkIHJldHVybiBGaWxlIG9iamVjdCcpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkuY2F0Y2goZSA9PiB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coZSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSBlbHNlIGlmIChyZXN1bHQgPT09IHRydWUpIHsKICAgICAgICAgICAgYWRkRmlsZVRvTGlzdCh1cGxvYWRlZEZpbGUpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBhZGRGaWxlVG9MaXN0KHVwbG9hZGVkRmlsZSk7CiAgICAgICAgfQogICAgICB9CiAgICB9OwogICAgLy8g5pq06Zyy5Ye6dXBsb2FkRmlsZXPmlrnms5UKICAgIGNvbnN0IHVwbG9hZEZpbGVzID0gKCkgPT4gewogICAgICBmaWxlc0xpc3QudmFsdWUuZmlsdGVyKGZpbGUgPT4gZmlsZS5zdGF0dXMgPSAncmVhZHknKS5mb3JFYWNoKHJlYWR5RmlsZSA9PiBwb3N0RmlsZShyZWFkeUZpbGUpKTsKICAgIH07CiAgICBsZXQgZXZlbnRzID0gewogICAgICAnY2xpY2snOiB0cmlnZ2VyVXBsb2FkZXIKICAgIH07CiAgICAvLyDlvZPkuIrkvKDmoYbmnInlm77niYcKICAgIGNvbnN0IGhhbmRsZUZpbGVDaGFuZ2UgPSBlID0+IHsKICAgICAgLy8gY29uc29sZS5sb2coZSk7CiAgICAgIGNvbnN0IHRhcmdldCA9IGUudGFyZ2V0OwogICAgICBjb25zdCBmaWxlcyA9IHRhcmdldC5maWxlczsKICAgICAgYmVmb3JlVXBsb2FkQ2hlY2soZmlsZXMpOwogICAgfTsKICAgIC8vIOaLlgogICAgY29uc3QgaGFuZGxlRHJhZyA9IChlLCBvdmVyKSA9PiB7CiAgICAgIC8vIOesrOS6jOS4quWPguaVsOS7o+ihqGNsYXNz5re75Yqg5oiW6ICF5LiN5re75YqgCiAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgaXNEcmFnT3Zlci52YWx1ZSA9IG92ZXI7CiAgICB9OwogICAgLy8g6JC95LiLCiAgICBjb25zdCBoYW5kbGVEcm9wID0gZSA9PiB7CiAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgaXNEcmFnT3Zlci52YWx1ZSA9IGZhbHNlOwogICAgICBpZiAoZS5kYXRhVHJhbnNmZXIpIHsKICAgICAgICAvLyDmi7/liLDmiZjmlL7kuIvnmoTmlbDmja4KICAgICAgICBiZWZvcmVVcGxvYWRDaGVjayhlLmRhdGFUcmFuc2Zlci5maWxlcyk7CiAgICAgIH0KICAgIH07CiAgICAvLyDmt7vliqDlhbbku5bnmoTkuovku7YKICAgIGlmIChwcm9wcy5kcmFnKSB7CiAgICAgIGV2ZW50cyA9IHsKICAgICAgICAuLi5ldmVudHMsCiAgICAgICAgJ2RyYWdvdmVyJzogZSA9PiB7CiAgICAgICAgICBoYW5kbGVEcmFnKGUsIHRydWUpOwogICAgICAgIH0sCiAgICAgICAgJ2RyYWdsZWF2ZSc6IGUgPT4gewogICAgICAgICAgaGFuZGxlRHJhZyhlLCBmYWxzZSk7CiAgICAgICAgfSwKICAgICAgICAnZHJvcCc6IGhhbmRsZURyb3AKICAgICAgfTsKICAgIH0KICAgIGV4cG9zZSh7CiAgICAgIHVwbG9hZEZpbGVzCiAgICB9KTsKICAgIGNvbnN0IF9fcmV0dXJuZWRfXyA9IHsKICAgICAgcHJvcHMsCiAgICAgIHN0b3JlLAogICAgICBmaWxlSW5wdXQsCiAgICAgIGZpbGVTdGF0dXMsCiAgICAgIGZpbGVzTGlzdCwKICAgICAgaXNEcmFnT3ZlciwKICAgICAgaXNVcGxvYWRpbmcsCiAgICAgIGxhc3RGaWxlRGF0YSwKICAgICAgcmVtb3ZlRmlsZSwKICAgICAgdHJpZ2dlclVwbG9hZGVyLAogICAgICBwb3N0RmlsZSwKICAgICAgYWRkRmlsZVRvTGlzdCwKICAgICAgYmVmb3JlVXBsb2FkQ2hlY2ssCiAgICAgIHVwbG9hZEZpbGVzLAogICAgICBnZXQgZXZlbnRzKCkgewogICAgICAgIHJldHVybiBldmVudHM7CiAgICAgIH0sCiAgICAgIHNldCBldmVudHModikgewogICAgICAgIGV2ZW50cyA9IHY7CiAgICAgIH0sCiAgICAgIGhhbmRsZUZpbGVDaGFuZ2UsCiAgICAgIGhhbmRsZURyYWcsCiAgICAgIGhhbmRsZURyb3AsCiAgICAgIGdldCBGaWxlSW1hZ2VPdXRsaW5lZCgpIHsKICAgICAgICByZXR1cm4gRmlsZUltYWdlT3V0bGluZWQ7CiAgICAgIH0sCiAgICAgIGdldCBMb2FkaW5nT3V0bGluZWQoKSB7CiAgICAgICAgcmV0dXJuIExvYWRpbmdPdXRsaW5lZDsKICAgICAgfSwKICAgICAgZ2V0IEZpbGVPdXRsaW5lZCgpIHsKICAgICAgICByZXR1cm4gRmlsZU91dGxpbmVkOwogICAgICB9CiAgICB9OwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KF9fcmV0dXJuZWRfXywgJ19faXNTY3JpcHRTZXR1cCcsIHsKICAgICAgZW51bWVyYWJsZTogZmFsc2UsCiAgICAgIHZhbHVlOiB0cnVlCiAgICB9KTsKICAgIHJldHVybiBfX3JldHVybmVkX187CiAgfQp9KTs="},{"version":3,"mappings":"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","names":["defineComponent","_defineComponent","ref","reactive","computed","FileImageOutlined","LoadingOutlined","FileOutlined","axios","v4","uuidv4","last","useStore","getImageDimensions","__name","props","action","type","String","default","beforeUpload","Function","drag","Boolean","autoUpload","listType","showUploadedList","setup","__props","expose","store","fileInput","fileStatus","filesList","isDragOver","isUploading","value","some","file","status","lastFileData","lastFile","loaded","data","resp","removeFile","id","filter","uid","triggerUploader","click","postFile","readyFile","formData","FormData","append","name","raw","post","headers","then","res","console","log","url","getWidth","width","maxWidth","error","setTimeout","imageProps","src","commit","catch","err","finally","addFileToList","uploadedFile","fileObj","size","fileReader","FileReader","readAsDataURL","addEventListener","result","push","beforeUploadCheck","files","Promise","processFile","File","Error","e","uploadFiles","forEach","events","handleFileChange","target","handleDrag","over","preventDefault","handleDrop","dataTransfer","__returned__","v","Object","defineProperty","enumerable"],"sourceRoot":"","sources":["D:\\vue3-project\\lego\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!D:\\vue3-project\\lego\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!D:\\vue3-project\\lego\\src\\components\\Uploader.vue?vue&type=script&setup=true&lang=ts"],"sourcesContent":["import { defineComponent as _defineComponent } from 'vue'\nimport { ref, reactive, computed, PropType } from 'vue'\r\nimport FileImageOutlined, {LoadingOutlined, FileOutlined} from '../../node_modules/@ant-design/icons-vue'\r\nimport axios from 'axios'\r\nimport { v4 as uuidv4} from 'uuid'\r\nimport { last } from 'lodash-es'\r\nimport { useStore } from 'vuex'\r\nimport {ImageComponentProps} from '../defaultProps'\r\nimport { getImageDimensions } from '../helper'\r\n\r\ntype uploadStatus = 'ready' | 'loading' | 'success' | 'error'\r\n// picture带预览的功能\r\ntype FileListType = 'picture' | 'text '\r\ntype CheckUpload = (file: File) => boolean | Promise<File>\r\nexport interface UploadFile {\r\n uid: string;\r\n name: string;\r\n size: number;\r\n status: string;\r\n raw: File;\r\n resp?: any;\r\n url?: string;\r\n width?: number;\r\n}\r\n\r\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'Uploader',\n  props: {\r\n  action: {\r\n    type: String,\r\n    default: 'http://localhost:3000/data'\r\n  },\r\n  beforeUpload: {\r\n    type: Function as PropType<CheckUpload>\r\n  },\r\n  // 是否开启拖拽上传\r\n  drag: {\r\n    type: Boolean,\r\n    default: false\r\n  },\r\n  // 默认自动上传\r\n  autoUpload: {\r\n    type: Boolean,\r\n    default: true\r\n  },\r\n  listType: {\r\n    type: String as PropType<FileListType>,\r\n    default: 'text'\r\n  },\r\n  showUploadedList: {\r\n    type: Boolean,\r\n    default: true\r\n  }\r\n},\n  setup(__props, { expose }) {\n\nconst props = __props;\n\r\n\r\n\r\nconst store = useStore()\r\n\r\nconst fileInput = ref<null | HTMLInputElement>(null)\r\nconst fileStatus = ref<uploadStatus>('ready')\r\nconst filesList = ref<UploadFile[]>([])\r\n// const uploadedFiles = ref<UploadFile[]>([])\r\nconst isDragOver = ref(false)\r\nconst isUploading = computed(() => {\r\n  // 只要有一项的等于loading，整个按钮就是isloading\r\n  return filesList.value.some(file => file.status === 'loading' )\r\n})\r\nconst lastFileData = computed(() => {\r\n  const lastFile = last(filesList.value)\r\n  if (lastFile) {\r\n    return {\r\n      loaded: lastFile.status === 'success',\r\n      data: lastFile.resp\r\n    }\r\n  }\r\n  return false\r\n})\r\nconst removeFile = (id: string) => {\r\n  filesList.value = filesList.value.filter(file => {\r\n    return file.uid !== id\r\n  })\r\n}\r\n\r\nconst triggerUploader = () => {\r\n  if (fileInput.value) {\r\n    fileInput.value.click()\r\n  }\r\n}\r\n\r\nconst postFile = (readyFile: UploadFile) => {\r\n  const formData = new FormData() \r\n  // const iseExistence = uploadedFiles.value.some((file) => file.name === fileObj.name )\r\n  // if(!iseExistence) {\r\n  // uploadedFiles.value.push(fileObj)\r\n  // }\r\n  \r\n  formData.append(readyFile.name, readyFile.raw)\r\n  readyFile.status = 'loading'\r\n  axios.post(props.action, formData, {\r\n    headers: {\r\n      'Content-Type': 'multipart/form-data'\r\n    }\r\n  }).then(res => {\r\n    console.log('上传成功',res.data);\r\n    // console.log(readyFile.raw);\r\n    // console.log(readyFile.url);\r\n    res.data.url = readyFile.url\r\n    fileStatus.value = 'success'\r\n    readyFile.status = 'success'\r\n    \r\n    const getWidth = (width: number) => {\r\n      const maxWidth = 375\r\n      res.data.width = (width > maxWidth) ? maxWidth : width\r\n    }\r\n    try {\r\n      getImageDimensions(res.data.url).then(async ({width}) => {\r\n      // getImageDimensions(readyFile.resp.url).then(async ({width}) => {\r\n        await getWidth(width)\r\n        // console.log('res.data', res.data);\r\n        \r\n      })\r\n    } catch (error) {\r\n      console.log('error', error);\r\n    }\r\n    readyFile.resp = res.data\r\n    // console.log('readyFile.resp.width',readyFile.resp.width);\r\n    setTimeout(() => {\r\n      const imageProps: Partial<ImageComponentProps> = {\r\n        src: readyFile.resp.url,\r\n        width: readyFile.resp.width\r\n      }\r\n      // console.log('imageProps',imageProps);\r\n      store.commit('addComponent', imageProps)\r\n    }, 500)\r\n    \r\n  }).catch((err) => {\r\n    console.log('上传失败', err);\r\n    fileStatus.value = 'error'\r\n    readyFile.status = 'error'\r\n  }).finally(() => {\r\n    if (fileInput.value) {\r\n      fileInput.value.value = ''\r\n    }\r\n  })\r\n}\r\n\r\nconst addFileToList = (uploadedFile: File) => {\r\n  const fileObj = reactive<UploadFile>({\r\n    uid: uuidv4(),\r\n    size: uploadedFile.size,\r\n    name: uploadedFile.name,\r\n    status: 'ready',\r\n    raw: uploadedFile\r\n  })\r\n  if (props.listType === 'picture') {\r\n    // 防止转换错误\r\n    // try {\r\n    //   fileObj.url = URL.createObjectURL(uploadedFile)\r\n    // } catch (err) {\r\n    //   console.error('upload file error', err)\r\n    // }\r\n    const fileReader = new FileReader()\r\n    fileReader.readAsDataURL(uploadedFile)\r\n    fileReader.addEventListener('load', () => {\r\n      fileObj.url = fileReader.result as string\r\n    })\r\n  }\r\n  filesList.value.push(fileObj)\r\n  // console.log(filesList.value);\r\n  \r\n  if (props.autoUpload) {\r\n    postFile(fileObj)\r\n  }\r\n}\r\n\r\nconst beforeUploadCheck = (files: null | FileList) => {\r\n  if (files) {\r\n    const uploadedFile = files[0]\r\n    // 上传前的检查\r\n    if (props.beforeUpload) {\r\n      const result = props.beforeUpload(uploadedFile)\r\n      if (result && result instanceof Promise) {\r\n        result.then(processFile => {\r\n          /**\r\n           * 新冒出来的对象，并不知道是什么类型，直接进行处理会有问题\r\n           */\r\n          // 这里并不知道processFile的类型，要判断\r\n          if (processFile instanceof File) {\r\n            addFileToList(processFile)\r\n          } else {\r\n            throw new Error('beforeUpload Promise should return File object')\r\n          }\r\n        }).catch(e => {\r\n          console.log(e);\r\n        })\r\n      } else if (result === true) {\r\n        addFileToList(uploadedFile)\r\n      }\r\n    } else {\r\n      addFileToList(uploadedFile)\r\n    }\r\n  }\r\n}\r\n\r\n// 暴露出uploadFiles方法\r\nconst uploadFiles = () => {\r\n  filesList.value.filter(file => file.status = 'ready').forEach(readyFile => postFile(readyFile))\r\n}\r\n\r\nlet events: { [key: string]: (e: any) => void } = {\r\n  'click': triggerUploader\r\n}\r\n\r\n// 当上传框有图片\r\nconst handleFileChange = (e: Event) => {\r\n  // console.log(e);\r\n  \r\n  const target = e.target as HTMLInputElement\r\n  const files = target.files\r\n  beforeUploadCheck(files)\r\n}\r\n\r\n// 拖\r\nconst handleDrag = (e: DragEvent, over: boolean) => {\r\n  // 第二个参数代表class添加或者不添加\r\n  e.preventDefault()\r\n  isDragOver.value = over\r\n}\r\n// 落下\r\nconst handleDrop = (e: DragEvent) => {\r\n  e.preventDefault()\r\n  isDragOver.value = false\r\n  if (e.dataTransfer) {\r\n    // 拿到托放下的数据\r\n    beforeUploadCheck(e.dataTransfer.files)\r\n  }\r\n}\r\n\r\n// 添加其他的事件\r\nif (props.drag) {\r\n  events = {\r\n    ...events,\r\n    'dragover': (e: DragEvent) => { handleDrag(e, true) },\r\n    'dragleave': (e: DragEvent) => { handleDrag(e, false) },\r\n    'drop': handleDrop\r\n  }\r\n}\r\n\r\nexpose({\r\n  uploadFiles\r\n})\r\n\r\n\nconst __returned__ = { props, store, fileInput, fileStatus, filesList, isDragOver, isUploading, lastFileData, removeFile, triggerUploader, postFile, addFileToList, beforeUploadCheck, uploadFiles, get events() { return events }, set events(v) { events = v }, handleFileChange, handleDrag, handleDrop, get FileImageOutlined() { return FileImageOutlined }, get LoadingOutlined() { return LoadingOutlined }, get FileOutlined() { return FileOutlined } }\nObject.defineProperty(__returned__, '__isScriptSetup', { enumerable: false, value: true })\nreturn __returned__\n}\n\n})"]}]}