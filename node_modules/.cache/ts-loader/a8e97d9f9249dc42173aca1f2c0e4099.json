{"remainingRequest":"D:\\vue3-project\\lego\\node_modules\\babel-loader\\lib\\index.js!D:\\vue3-project\\lego\\node_modules\\ts-loader\\index.js??ref--15-2!D:\\vue3-project\\lego\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!D:\\vue3-project\\lego\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!D:\\vue3-project\\lego\\src\\components\\Uploader.vue?vue&type=script&setup=true&lang=ts","dependencies":[{"path":"D:\\vue3-project\\lego\\src\\components\\Uploader.vue","mtime":1676531518618},{"path":"D:\\vue3-project\\lego\\babel.config.js","mtime":1674816650140},{"path":"D:\\vue3-project\\lego\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1674816758787},{"path":"D:\\vue3-project\\lego\\node_modules\\babel-loader\\lib\\index.js","mtime":1674816767357},{"path":"D:\\vue3-project\\lego\\node_modules\\ts-loader\\index.js","mtime":1674816768512},{"path":"D:\\vue3-project\\lego\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1674816758787},{"path":"D:\\vue3-project\\lego\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1674816769351}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCB7IGRlZmluZUNvbXBvbmVudCBhcyBfZGVmaW5lQ29tcG9uZW50IH0gZnJvbSAndnVlJzsKaW1wb3J0IHsgcmVmLCByZWFjdGl2ZSwgY29tcHV0ZWQgfSBmcm9tICd2dWUnOwppbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnOwppbXBvcnQgeyB2NCBhcyB1dWlkdjQgfSBmcm9tICd1dWlkJzsKZXhwb3J0IGRlZmF1bHQgLyojX19QVVJFX18qL19kZWZpbmVDb21wb25lbnQoewogIF9fbmFtZTogJ1VwbG9hZGVyJywKICBwcm9wczogewogICAgYWN0aW9uOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgZGVmYXVsdDogJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9kYXRhJwogICAgfQogIH0sCiAgc2V0dXAoX19wcm9wcywgewogICAgZXhwb3NlCiAgfSkgewogICAgZXhwb3NlKCk7CiAgICBjb25zdCBwcm9wcyA9IF9fcHJvcHM7CiAgICBjb25zdCBmaWxlSW5wdXQgPSByZWYobnVsbCk7CiAgICBjb25zdCBmaWxlU3RhdHVzID0gcmVmKCdyZWFkeScpOwogICAgY29uc3QgdXBsb2FkZWRGaWxlcyA9IHJlZihbXSk7CiAgICBjb25zdCBpc1VwbG9hZGluZyA9IGNvbXB1dGVkKCgpID0+IHsKICAgICAgLy8g5Y+q6KaB5pyJ5LiA6aG555qE562J5LqObG9hZGluZ++8jOaVtOS4quaMiemSruWwseaYr2lzbG9hZGluZwogICAgICByZXR1cm4gdXBsb2FkZWRGaWxlcy52YWx1ZS5zb21lKGZpbGUgPT4gZmlsZS5zdGF0dXMgPT09ICdsb2FkaW5nJyk7CiAgICB9KTsKICAgIGNvbnN0IHJlbW92ZUZpbGUgPSBpZCA9PiB7CiAgICAgIHVwbG9hZGVkRmlsZXMudmFsdWUgPSB1cGxvYWRlZEZpbGVzLnZhbHVlLmZpbHRlcihmaWxlID0+IHsKICAgICAgICByZXR1cm4gZmlsZS51aWQgIT09IGlkOwogICAgICB9KTsKICAgIH07CiAgICBjb25zdCB0cmlnZ2VyVXBsb2FkZXIgPSAoKSA9PiB7CiAgICAgIGlmIChmaWxlSW5wdXQudmFsdWUpIHsKICAgICAgICBmaWxlSW5wdXQudmFsdWUuY2xpY2soKTsKICAgICAgfQogICAgfTsKICAgIGNvbnN0IGhhbmRsZUZpbGVDaGFuZ2UgPSBlID0+IHsKICAgICAgY29uc3QgdGFyZ2V0ID0gZS50YXJnZXQ7CiAgICAgIGNvbnN0IGZpbGVzID0gdGFyZ2V0LmZpbGVzOwogICAgICBpZiAoZmlsZXMpIHsKICAgICAgICBjb25zdCB1cGxvYWRlZEZpbGUgPSBmaWxlc1swXTsKICAgICAgICBjb25zdCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpOwogICAgICAgIGNvbnN0IGZpbGVPYmogPSByZWFjdGl2ZSh7CiAgICAgICAgICB1aWQ6IHV1aWR2NCgpLAogICAgICAgICAgc2l6ZTogdXBsb2FkZWRGaWxlLnNpemUsCiAgICAgICAgICBuYW1lOiB1cGxvYWRlZEZpbGUubmFtZSwKICAgICAgICAgIHN0YXR1czogJ2xvYWRpbmcnLAogICAgICAgICAgcmF3OiB1cGxvYWRlZEZpbGUKICAgICAgICB9KTsKICAgICAgICAvLyBjb25zdCBpc2VFeGlzdGVuY2UgPSB1cGxvYWRlZEZpbGVzLnZhbHVlLnNvbWUoKGZpbGUpID0+IGZpbGUubmFtZSA9PT0gZmlsZU9iai5uYW1lICkKICAgICAgICAvLyBpZighaXNlRXhpc3RlbmNlKSB7CiAgICAgICAgdXBsb2FkZWRGaWxlcy52YWx1ZS5wdXNoKGZpbGVPYmopOwogICAgICAgIC8vIH0KICAgICAgICBmb3JtRGF0YS5hcHBlbmQodXBsb2FkZWRGaWxlLm5hbWUsIHVwbG9hZGVkRmlsZSk7CiAgICAgICAgZmlsZVN0YXR1cy52YWx1ZSA9ICdsb2FkaW5nJzsKICAgICAgICBheGlvcy5wb3N0KHByb3BzLmFjdGlvbiwgewogICAgICAgICAgYm9keTogZm9ybURhdGEKICAgICAgICB9LCB7CiAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnbXVsdGlwYXJ0L2Zvcm0tZGF0YScKICAgICAgICAgIH0KICAgICAgICB9KS50aGVuKHJlcyA9PiB7CiAgICAgICAgICBjb25zb2xlLmxvZyhyZXMuZGF0YSk7CiAgICAgICAgICBmaWxlU3RhdHVzLnZhbHVlID0gJ3N1Y2Nlc3MnOwogICAgICAgICAgZmlsZU9iai5zdGF0dXMgPSAnc3VjY2Vzcyc7CiAgICAgICAgICBmaWxlT2JqLnJlc3AgPSByZXMuZGF0YTsKICAgICAgICB9KS5jYXRjaCgoKSA9PiB7CiAgICAgICAgICBmaWxlU3RhdHVzLnZhbHVlID0gJ2Vycm9yJzsKICAgICAgICAgIGZpbGVPYmouc3RhdHVzID0gJ2Vycm9yJzsKICAgICAgICB9KS5maW5hbGx5KCgpID0+IHsKICAgICAgICAgIGlmIChmaWxlSW5wdXQudmFsdWUpIHsKICAgICAgICAgICAgZmlsZUlucHV0LnZhbHVlLnZhbHVlID0gJyc7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH07CiAgICBjb25zdCBfX3JldHVybmVkX18gPSB7CiAgICAgIHByb3BzLAogICAgICBmaWxlSW5wdXQsCiAgICAgIGZpbGVTdGF0dXMsCiAgICAgIHVwbG9hZGVkRmlsZXMsCiAgICAgIGlzVXBsb2FkaW5nLAogICAgICByZW1vdmVGaWxlLAogICAgICB0cmlnZ2VyVXBsb2FkZXIsCiAgICAgIGhhbmRsZUZpbGVDaGFuZ2UKICAgIH07CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoX19yZXR1cm5lZF9fLCAnX19pc1NjcmlwdFNldHVwJywgewogICAgICBlbnVtZXJhYmxlOiBmYWxzZSwKICAgICAgdmFsdWU6IHRydWUKICAgIH0pOwogICAgcmV0dXJuIF9fcmV0dXJuZWRfXzsKICB9Cn0pOw=="},{"version":3,"mappings":"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","names":["defineComponent","_defineComponent","ref","reactive","computed","axios","v4","uuidv4","__name","props","action","type","String","default","setup","__props","expose","fileInput","fileStatus","uploadedFiles","isUploading","value","some","file","status","removeFile","id","filter","uid","triggerUploader","click","handleFileChange","e","target","files","uploadedFile","formData","FormData","fileObj","size","name","raw","push","append","post","body","headers","then","res","console","log","data","resp","catch","finally","__returned__","Object","defineProperty","enumerable"],"sourceRoot":"","sources":["D:\\vue3-project\\lego\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!D:\\vue3-project\\lego\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!D:\\vue3-project\\lego\\src\\components\\Uploader.vue?vue&type=script&setup=true&lang=ts"],"sourcesContent":["import { defineComponent as _defineComponent } from 'vue'\nimport { ref, reactive, computed } from 'vue'\r\nimport axios from 'axios'\r\nimport { v4 as uuidv4} from 'uuid'\r\n\r\ntype uploadStatus = 'ready' | 'loading' | 'success' | 'error'\r\nexport interface UploadFile {\r\n uid: string;\r\n name: string;\r\n size: number;\r\n status: string;\r\n raw: File;\r\n resp?: any;\r\n}\r\n\r\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'Uploader',\n  props: {\r\n  action: {\r\n    type: String,\r\n    default: 'http://localhost:3000/data'\r\n  }\r\n},\n  setup(__props, { expose }) {\n  expose();\n\nconst props = __props;\n\r\n\r\n\r\nconst fileInput = ref<null | HTMLInputElement>(null)\r\nconst fileStatus = ref<uploadStatus>('ready')\r\nconst uploadedFiles = ref<UploadFile[]>([])\r\nconst isUploading = computed(() => {\r\n  // 只要有一项的等于loading，整个按钮就是isloading\r\n  return uploadedFiles.value.some(file => file.status === 'loading' )\r\n})\r\nconst removeFile = (id: string) => {\r\n  uploadedFiles.value = uploadedFiles.value.filter(file => {\r\n    return file.uid !== id\r\n  })\r\n}\r\n\r\nconst triggerUploader = () => {\r\n  if (fileInput.value) {\r\n    fileInput.value.click()\r\n  }\r\n}\r\n\r\nconst handleFileChange = (e: Event) => {\r\n  const target = e.target as HTMLInputElement\r\n  const files = target.files\r\n  if (files) {\r\n    const uploadedFile = files[0]\r\n    const formData = new FormData()\r\n    const fileObj = reactive<UploadFile>({\r\n      uid: uuidv4(),\r\n      size: uploadedFile.size,\r\n      name: uploadedFile.name,\r\n      status: 'loading',\r\n      raw: uploadedFile\r\n    })\r\n    // const iseExistence = uploadedFiles.value.some((file) => file.name === fileObj.name )\r\n    // if(!iseExistence) {\r\n    uploadedFiles.value.push(fileObj)\r\n    // }\r\n    \r\n    formData.append(uploadedFile.name, uploadedFile)\r\n    fileStatus.value = 'loading'\r\n    axios.post(props.action, {body: formData}, {\r\n      headers: {\r\n        'Content-Type': 'multipart/form-data'\r\n      }\r\n    }).then(res => {\r\n      console.log(res.data);\r\n      fileStatus.value = 'success'\r\n      fileObj.status = 'success'\r\n      fileObj.resp = res.data\r\n    }).catch(() => {\r\n      fileStatus.value = 'error'\r\n      fileObj.status = 'error'\r\n    }).finally(() => {\r\n      if (fileInput.value) {\r\n        fileInput.value.value = ''\r\n      }\r\n    })\r\n  }\r\n}\r\n\r\n\nconst __returned__ = { props, fileInput, fileStatus, uploadedFiles, isUploading, removeFile, triggerUploader, handleFileChange }\nObject.defineProperty(__returned__, '__isScriptSetup', { enumerable: false, value: true })\nreturn __returned__\n}\n\n})"]}]}