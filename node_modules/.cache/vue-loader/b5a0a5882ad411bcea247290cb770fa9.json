{"remainingRequest":"D:\\vue3-project\\lego\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!D:\\vue3-project\\lego\\src\\components\\Uploader.vue?vue&type=template&id=3c8050c4&ts=true","dependencies":[{"path":"D:\\vue3-project\\lego\\src\\components\\Uploader.vue","mtime":1676285651937},{"path":"D:\\vue3-project\\lego\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1674816758787},{"path":"D:\\vue3-project\\lego\\node_modules\\babel-loader\\lib\\index.js","mtime":1674816767357},{"path":"D:\\vue3-project\\lego\\node_modules\\ts-loader\\index.js","mtime":1674816768512},{"path":"D:\\vue3-project\\lego\\node_modules\\vue-loader-v16\\dist\\templateLoader.js","mtime":1674816774476},{"path":"D:\\vue3-project\\lego\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1674816758787},{"path":"D:\\vue3-project\\lego\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1674816769351}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQogIDxkaXYgY2xhc3M9IiI+DQogICAgPGJ1dHRvbiBAY2xpY2s9InRyaWdnZXJVcGxvYWRlciI+DQogICAgICA8c3BhbiB2LWlmPSJmaWxlU3RhdHVzID09PSAnbG9hZGluZyciPuato+WcqOS4iuS8oDwvc3Bhbj4NCiAgICAgIDxzcGFuIHYtZWxzZS1pZj0iZmlsZVN0YXR1cyA9PT0gJ3N1Y2Nlc3MnIj7kuIrkvKDmiJDlip88L3NwYW4+DQogICAgICA8c3BhbiB2LWVsc2UtaWY9ImZpbGVTdGF0dXMgPT09ICdlcnJvciciPuS4iuS8oOWksei0pTwvc3Bhbj4NCiAgICAgIDxzcGFuIHYtZWxzZT7kuIrkvKDmlofku7Y8L3NwYW4+DQogICAgPC9idXR0b24+DQogICAgPGlucHV0DQogICAgICB0eXBlPSJmaWxlIg0KICAgICAgcmVmPSJmaWxlSW5wdXQiDQogICAgICA6c3R5bGU9IntkaXNwbGF5OiAnbm9uZSd9Ig0KICAgICAgQGNoYW5nZT0iaGFuZGxlRmlsZUNoYW5nZSINCiAgICAvPg0KICA8L2Rpdj4NCg=="},{"version":3,"sources":["D:\\vue3-project\\lego\\src\\components\\Uploader.vue"],"names":[],"mappings":";EACE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACX,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MAC9B,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MAChD,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MACrD,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MACnD,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACzB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACR,CAAC,CAAC,CAAC,CAAC,CAAC;MACH,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MACV,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MACd,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MACzB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAC3B,CAAC;EACH,CAAC,CAAC,CAAC,CAAC,CAAC","file":"D:/vue3-project/lego/src/components/Uploader.vue","sourceRoot":"","sourcesContent":["<template>\r\n  <div class=\"\">\r\n    <button @click=\"triggerUploader\">\r\n      <span v-if=\"fileStatus === 'loading'\">正在上传</span>\r\n      <span v-else-if=\"fileStatus === 'success'\">上传成功</span>\r\n      <span v-else-if=\"fileStatus === 'error'\">上传失败</span>\r\n      <span v-else>上传文件</span>\r\n    </button>\r\n    <input\r\n      type=\"file\"\r\n      ref=\"fileInput\"\r\n      :style=\"{display: 'none'}\"\r\n      @change=\"handleFileChange\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, defineProps, reactive } from 'vue'\r\nimport axios from 'axios'\r\nimport { v4 as uuidv4} from 'uuid'\r\n\r\ntype uploadStatus = 'ready' | 'loading' | 'success' | 'error'\r\nexport interface UploadFile {\r\n uid: string;\r\n name: string;\r\n size: number;\r\n status: string;\r\n raw: File;\r\n}\r\n\r\nconst props = defineProps({\r\n  action: {\r\n    type: String\r\n  }\r\n})\r\n\r\nconst fileInput = ref<null | HTMLInputElement>(null)\r\nconst fileStatus = ref<uploadStatus>('ready')\r\nconst uploadedFiles = ref<UploadFile[]>([])\r\n\r\nconst triggerUploader = () => {\r\n  if (fileInput.value) {\r\n    fileInput.value.click()\r\n  }\r\n}\r\n\r\nconst handleFileChange = (e: Event) => {\r\n  const target = e.target as HTMLInputElement\r\n  const files = target.files\r\n  if (files) {\r\n    const uploadedFile = files[0]\r\n    const formData = new FormData()\r\n    const fileObj = reactive<UploadFile>({\r\n      uid: uuidv4(),\r\n      size: uploadedFile.size,\r\n      name: uploadedFile.name,\r\n      status: 'loading',\r\n      raw: uploadedFile\r\n    })\r\n    uploadedFiles.value.push(fileObj)\r\n    formData.append(uploadedFile.name, uploadedFile)\r\n    fileStatus.value = 'loading'\r\n    axios.post(props.action, formData, {\r\n      headers: {\r\n        'Content-Type': 'multipart/form-data'\r\n      }\r\n    }).then(res => {\r\n      console.log(res.data);\r\n      fileStatus.value = 'success'\r\n      fileObj.status = 'success'\r\n    }).catch(() => {\r\n      fileStatus.value = 'error'\r\n      fileObj.status = 'error'\r\n    })\r\n  }\r\n}\r\n\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n</style>\r\n"]}]}